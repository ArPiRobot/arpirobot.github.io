
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://arpirobot.github.io/1.0/guide/programming/pid/">
      
      
        <link rel="prev" href="../sensoractions/">
      
      
        <link rel="next" href="../examplesrepo/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.1">
    
    
      
        <title>PID Controller - ArPiRobot</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.402914a4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="deep-orange">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#about-pid-controllers" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="ArPiRobot" class="md-header__button md-logo" aria-label="ArPiRobot" data-md-component="logo">
      
  <img src="../../../img/framework-logo/robot-nobg.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ArPiRobot
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              PID Controller
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/orgs/ArPiRobot/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../downloads/" class="md-tabs__link">
      Downloads
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../gettingstarted/" class="md-tabs__link md-tabs__link--active">
        Guide
      </a>
    </li>
  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../ref/manuals/drive_station/" class="md-tabs__link">
        Documentation
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../devs/overview/" class="md-tabs__link">
        Framework Developers
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="ArPiRobot" class="md-nav__button md-logo" aria-label="ArPiRobot" data-md-component="logo">
      
  <img src="../../../img/framework-logo/robot-nobg.png" alt="logo">

    </a>
    ArPiRobot
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/orgs/ArPiRobot/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../downloads/" class="md-nav__link">
        Downloads
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../gettingstarted/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
      
      
      
        <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
          Building a Robot
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Building a Robot
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/requiredhardware/" class="md-nav__link">
        Required Components
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/supportedhardware/" class="md-nav__link">
        Supported Hardware
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/examplebuilds/" class="md-nav__link">
        Example Robot Builds
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
          Software Setup
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          Software Setup
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../setup/setupcomputer/" class="md-nav__link">
        Setup your Development Computer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../setup/setuppi/" class="md-nav__link">
        Setup the Robot's Main Computer
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
          Programming the Robot
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3_4">
          <span class="md-nav__icon md-icon"></span>
          Programming the Robot
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../createproject/" class="md-nav__link">
        Creating a Project
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../movingmotors/" class="md-nav__link">
        Moving Motors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../drivegamepad/" class="md-nav__link">
        Driving with Gamepad
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sensordata/" class="md-nav__link">
        Sensor Data & NetworkTable
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../actions/" class="md-nav__link">
        Using Actions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sensoractions/" class="md-nav__link">
        Using Sensors with Actions
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          PID Controller
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        PID Controller
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#about-pid-controllers" class="md-nav__link">
    About PID Controllers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-for-a-pid-controller" class="md-nav__link">
    Code for a PID Controller
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rotate-angle-action-using-pid" class="md-nav__link">
    Rotate Angle Action using PID
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tuning-a-pid" class="md-nav__link">
    Tuning a PID
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extra-adding-pid-info-gains-to-network-table" class="md-nav__link">
    Extra: Adding PID Info / Gains to Network Table
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examplesrepo/" class="md-nav__link">
        Examples Repo
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
      
      
      
        <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
          Other Tasks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_5">
          <span class="md-nav__icon md-icon"></span>
          Other Tasks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../other/audio/" class="md-nav__link">
        Playing Audio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../other/camstream/" class="md-nav__link">
        Camera Streaming
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../other/ssh/" class="md-nav__link">
        Connect by SSH
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../other/wifidebug/" class="md-nav__link">
        WiFi Debugging
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
      
      
      
        <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
          Custom Parts
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_6">
          <span class="md-nav__icon md-icon"></span>
          Custom Parts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../custom/quadencoder/" class="md-nav__link">
        TT Motor Quadrature Encoder
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Documentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
      
      
      
        <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
          Manuals
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Manuals
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ref/manuals/drive_station/" class="md-nav__link">
        Drive Station Manual
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ref/manuals/deploy_tool/" class="md-nav__link">
        Deploy Tool Manual
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ref/manuals/android_drive_station/" class="md-nav__link">
        Mobile Drive Station Manual
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
      
      
      
        <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
          Programming Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Programming Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ref/projectstructure/" class="md-nav__link">
        Project Structure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ref/baserobot/" class="md-nav__link">
        BaseRobot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ref/devices/" class="md-nav__link">
        Devices
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ref/arduino/" class="md-nav__link">
        Arduino Sensor Coprocessor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ref/nettable/" class="md-nav__link">
        Network Table
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ref/actionsystem/" class="md-nav__link">
        Action System
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
      
      
      
        <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
          CoreLib API Docs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          CoreLib API Docs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../doxygen-docs/cpp/html/index.html" class="md-nav__link">
        Doxygen (C++)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../doxygen-docs/python/html/index.html" class="md-nav__link">
        Doxygen (Python)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../defaultsettings/" class="md-nav__link">
        Default Robot Settings
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Framework Developers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Framework Developers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../devs/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../devs/corelib/" class="md-nav__link">
        Core Library (CoreLib)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../devs/arduinofw/" class="md-nav__link">
        Arduino Firmware
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../devs/os_image_config/" class="md-nav__link">
        OS Image Description
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../devs/new_release/" class="md-nav__link">
        Publish New Release
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#about-pid-controllers" class="md-nav__link">
    About PID Controllers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-for-a-pid-controller" class="md-nav__link">
    Code for a PID Controller
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rotate-angle-action-using-pid" class="md-nav__link">
    Rotate Angle Action using PID
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tuning-a-pid" class="md-nav__link">
    Tuning a PID
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extra-adding-pid-info-gains-to-network-table" class="md-nav__link">
    Extra: Adding PID Info / Gains to Network Table
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>PID Controller</h1>

<h2 id="about-pid-controllers">About PID Controllers</h2>
<p><em>Note: This is a very high-level overview of PID controllers as they exist in and pertain to the ArPiRobot Core Library. This is not intended to be a heavily mathematical discussion. For more details on PID controllers it is recommended to read <a href="https://en.wikipedia.org/wiki/PID_controller">Wikipedia's Page</a> on the topic. Additionally, this guide often oversimplifies or generalizes some concepts to how they often apply in the ArPiRobot Core Library or in robotics applications.</em></p>
<p>PID controllers are a common way of using sensor data to make a robot perform some measurable action. In very oversimplified terms, a PID controller is given a target (or setpoint). This setpoint is a target sensor value to reach. The PID controller is then repeatedly given the current sensor value. Using this value and some parameters (which will be discussed later) it calculates a value. This value is to be used to make the robot progress towards having the sensor reach its setpoint. The exact value depends on several factors, but by default it is between <code>-1.0</code> and <code>1.0</code> allowing it to be easily passed to a drive helper to move motors. The exact value returned depends on the "error" (or the difference between setpoint and current sensor value) and the values of parameters described below.</p>
<p>A PID controller uses three parameters (or gains).
- Proportional Gain (kP): The proportional gain is typically used to drive the behavior of the controller. The kP value is multiplied by the error, meaning the output is larger when the error is large, and becomes smaller as the error shrinks. Generally too large of a kP term will cause the robot to oscillate about the setpoint (and never settle at the setpoint) and too small of a kP may result in a significant "steady state error" (which is when the robot stops moving, but is not at the setpoint).
- Integral Gain (kI): An integral gain is used to reduce steady state error. It is multiplied by error over time. Note that the kI value will often be very small and should generally be much smaller than the kP value. Increasing KI also increases oscillation before the robot settles at the setpoint. Generally, too large of a kI will cause oscillation that never settles at the setpoint and too small of a kI will result in steady state error taking "too long" to eliminate.
- Derivative Gain (kD): This term is used to reduce how quickly the error changes (and thus has the effect of reducing oscillation). Increasing kD is commonly a way of reducing oscillation due to kP and / or kI. However, too high of a kD will cause unpredictable results. Generally, kD is much smaller than kP.</p>
<p>Generally speaking, the following combinations of parameters may be used
- P alone is sometimes sufficient (typically if steady state error is not really an issue)
- PI is good enough in some cases (typically if small amounts of oscillation before reaching the setpoint)
- PD is rarely used, but has some uses (typically if there is just a little too much oscillation). However, it is often better to reduce kP (allowing some steady state error) and increase kI (to correct the error) before adding a kD term.</p>
<p>Additionally, the PID controller object in the ArPiRobot Core Library has one more term. An "F" or feed-forward term. This is a very simple term that is only useful in certain scenarios. The kF value is multiplied by the setpoint to produce a "baseline" output. This is useful with velocity control for example. The kF can get close to the target and a small kP and / or kI (and sometimes kD) can correct for error / changes in resistance.</p>
<h2 id="code-for-a-pid-controller">Code for a PID Controller</h2>
<p>The ArPiRobot Core Library includes a <code>PID</code> object. This object supports setting all four gains previously described, as well as a min and max output (defaulting to -1.0 and 1.0 respectively). The gains can be changed at any time.</p>
<p>The <code>set_setpoint</code> / <code>setSetpoint</code> function is used to assign a setpoint for the PID controller. The <code>get_output</code> / <code>getOutput</code> function is used to calculate the current output. This function is passed the current sensor value as an argument and returns the output. For mathematical reasons, this function should be called at fairly regular intervals. As such, this makes <code>Action</code>s a good candidate to use PID objects. However, it is generally recommended to keep all PID object instances in the <code>Robot</code> class. This makes it easier to use the network table to help with tuning and allows multiple actions to reuse the same PID (without having to use the same gains in multiple places in the code).</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:3"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Python (<code>actions.py</code>)</label><label for="__tabbed_1_2">C++ (<code>actions.hpp</code>)</label><label for="__tabbed_1_3">C++ (<code>actions.cpp</code>)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">PIDAction</span><span class="p">(</span><span class="n">Action</span><span class="p">):</span>
    <span class="c1"># Assumes my_pid is defined as a member of Robot class</span>
    <span class="c1"># Assumes tuning is somewhere in robot_started or elsewhere in Robot class</span>
    <span class="c1"># For example, it could be hard coded during instantiation</span>
    <span class="c1"># Ex: In Robot __init__</span>
    <span class="c1">#       self.my_pid = PID(1.0, 0.0, 0.0)</span>

    <span class="k">def</span> <span class="nf">begin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Reset before each use (clears previous state info)</span>
        <span class="n">main</span><span class="o">.</span><span class="n">robot</span><span class="o">.</span><span class="n">my_pid</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

        <span class="c1"># Use the setpoint for this action</span>
        <span class="n">main</span><span class="o">.</span><span class="n">robot</span><span class="o">.</span><span class="n">my_pid</span><span class="o">.</span><span class="n">set_setpoint</span><span class="p">(</span><span class="n">setpoint_for_this_action</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Get sensor value</span>
        <span class="n">current_pv</span> <span class="o">=</span> <span class="n">main</span><span class="o">.</span><span class="n">robot</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span>

        <span class="c1"># Calculate output from PID</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">main</span><span class="o">.</span><span class="n">robot</span><span class="o">.</span><span class="n">my_pid</span><span class="o">.</span><span class="n">get_output</span><span class="p">(</span><span class="n">current_pv</span><span class="p">)</span>

        <span class="c1"># Do something with PID output</span>
        <span class="c1"># Maybe move motors</span>

    <span class="k">def</span> <span class="nf">finish</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">was_interrupted</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="c1"># Stop any motors or anything the PID was moving</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">should_continue</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># Once setpoint is reached, stop</span>
        <span class="c1"># Note: determining if setpoint is reached is not always trivial</span>
        <span class="c1">#       due to possible oscillations</span>
        <span class="k">if</span> <span class="n">pid_done</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// Assumes myPid is defined as a member of Robot class</span>
<span class="c1">// Assumes tuning is somewhere in robot_started or elsewhere in Robot class</span>
<span class="c1">// For example, it could be hard coded during instantiation</span>
<span class="c1">// Ex: In Robot class declaration</span>
<span class="c1">//       PID myPid { 1.0, 0.0, 0.0 };</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PIDAction</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Action</span><span class="w"> </span><span class="p">{</span>
<span class="k">protected</span><span class="o">:</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">begin</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">process</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">finish</span><span class="p">(</span><span class="kt">bool</span><span class="w"> </span><span class="n">wasInterrupted</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="nf">shouldContinue</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">PIDAction::begin</span><span class="p">(){</span>
<span class="w">    </span><span class="c1">// Reset before each use (clears previous state info)</span>
<span class="w">    </span><span class="n">Main</span><span class="o">::</span><span class="n">robot</span><span class="o">-&gt;</span><span class="n">myPid</span><span class="p">.</span><span class="n">reset</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// Use the setpoint for this action</span>
<span class="w">    </span><span class="n">Main</span><span class="o">::</span><span class="n">robot</span><span class="o">-&gt;</span><span class="n">myPid</span><span class="p">.</span><span class="n">setSetpoint</span><span class="p">(</span><span class="n">setpointForThisAction</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">PIDAction::process</span><span class="p">(){</span>
<span class="w">    </span><span class="c1">// Get sensor value</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">currentPv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Main</span><span class="o">::</span><span class="n">robot</span><span class="o">-&gt;</span><span class="n">sensor</span><span class="p">.</span><span class="n">getValue</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// Calculate output from PID</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Main</span><span class="o">::</span><span class="n">robot</span><span class="p">.</span><span class="n">myPid</span><span class="p">.</span><span class="n">getOutput</span><span class="p">(</span><span class="n">currentPv</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Do something with PID output</span>
<span class="w">    </span><span class="c1">// Maybe move motors</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">PIDAction::finish</span><span class="p">(</span><span class="kt">bool</span><span class="w"> </span><span class="n">wasInterrupted</span><span class="p">){</span>
<span class="w">    </span><span class="c1">// Stop any motors or anything the PID was moving</span>
<span class="p">}</span>

<span class="kt">bool</span><span class="w"> </span><span class="nf">PIDAction::shouldContinue</span><span class="p">(){</span>
<span class="w">    </span><span class="c1">// Once setpoint is reached, stop</span>
<span class="w">    </span><span class="c1">// Note: determining if setpoint is reached is not always trivial</span>
<span class="w">    </span><span class="c1">//       due to possible oscillations</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">pidDone</span><span class="p">){</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="rotate-angle-action-using-pid">Rotate Angle Action using PID</h2>
<p>To improve the <code>RotateAngleAction</code> from the previous section, a PID can be used. This will help reduce overshooting the angle and will improve consistency of arriving at the correct angle after rotation actions complete.</p>
<p>Before implementing the action, a rotation PID controller needs to be added to the <code>Robot</code> class.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Python (<code>robot.py</code>)</label><label for="__tabbed_2_2">C++ (<code>robot.hpp</code>)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># Add with other imports</span>
<span class="kn">from</span> <span class="nn">arpirobot.core.control</span> <span class="kn">import</span> <span class="n">PID</span>

<span class="c1"># in Robot&#39;s __init__ function</span>
<span class="c1"># Arguments: kp, ki, kd, kf, min, max</span>
<span class="c1"># If arguments are omitted, they default to 0.0 for gains or -1.0 / 1.0 for min / max</span>
<span class="c1"># min / max define range of PID controller&#39;s output values</span>
<span class="c1"># -1.0 to 1.0 is used as this is the range of rotation speeds accepted by a drive helper</span>
<span class="bp">self</span><span class="o">.</span><span class="n">rotate_pid</span> <span class="o">=</span> <span class="n">PID</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// Add with other includes</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;arpirobot/core/control/PID.hpp&gt;</span>

<span class="c1">// With other member variables in Robot class</span>
<span class="c1">// Arguments: kp, ki, kd, kf, min, max</span>
<span class="c1">// If arguments are omitted, they default to 0.0 for gains or -1.0 / 1.0 for min / max</span>
<span class="c1">// min / max define range of PID controller&#39;s output values</span>
<span class="c1">// -1.0 to 1.0 is used as this is the range of rotation speeds accepted by a drive helper</span>
<span class="n">PID</span><span class="w"> </span><span class="n">rotatePid</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="p">};</span>
</code></pre></div>
</div>
</div>
</div>
<p>The initial gains and output range for the PID controller are passed as arguments to the constructor, but they can all be changed later using set functions.</p>
<p>An action to rotate using the PID controller can be implemented as shown below</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:3"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><input id="__tabbed_3_3" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Python (<code>actions.py</code>)</label><label for="__tabbed_3_2">C++ (<code>actions.hpp</code>)</label><label for="__tabbed_3_3">C++ (actions.cpp`)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">RotatePIDAction</span><span class="p">(</span><span class="n">Action</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">degrees</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># Store the angle this action instance should rotate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">degrees</span> <span class="o">=</span> <span class="n">degrees</span>

        <span class="c1"># This will be used to detect when the robot has reached its target</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">correct_counter</span> <span class="o">=</span> <span class="mi">0</span>


    <span class="k">def</span> <span class="nf">begin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Reset correct counter to zero</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">correct_counter</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Put motors in brake mode (often better for automated actions)</span>
        <span class="n">main</span><span class="o">.</span><span class="n">robot</span><span class="o">.</span><span class="n">flmotor</span><span class="o">.</span><span class="n">set_brake_mode</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">main</span><span class="o">.</span><span class="n">robot</span><span class="o">.</span><span class="n">frmotor</span><span class="o">.</span><span class="n">set_brake_mode</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">main</span><span class="o">.</span><span class="n">robot</span><span class="o">.</span><span class="n">rlmotor</span><span class="o">.</span><span class="n">set_brake_mode</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">main</span><span class="o">.</span><span class="n">robot</span><span class="o">.</span><span class="n">rrmotor</span><span class="o">.</span><span class="n">set_brake_mode</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Configure rotate PID controller for use</span>
        <span class="c1"># Reset it to a clean state and set a new setpoint</span>
        <span class="c1"># Setpoint is target angle, which is self.degrees away from where the robot is currently facing</span>
        <span class="n">main</span><span class="o">.</span><span class="n">robot</span><span class="o">.</span><span class="n">rotate_pid</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="n">main</span><span class="o">.</span><span class="n">robot</span><span class="o">.</span><span class="n">rotate_pid</span><span class="o">.</span><span class="n">set_setpoint</span><span class="p">(</span><span class="n">main</span><span class="o">.</span><span class="n">robot</span><span class="o">.</span><span class="n">imu</span><span class="o">.</span><span class="n">get_gyro_z</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">degrees</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Calculate the rotation speed using the PID</span>
        <span class="n">rot</span> <span class="o">=</span> <span class="n">main</span><span class="o">.</span><span class="n">robot</span><span class="o">.</span><span class="n">rotate_pid</span><span class="o">.</span><span class="n">get_output</span><span class="p">(</span><span class="n">main</span><span class="o">.</span><span class="n">robot</span><span class="o">.</span><span class="n">imu</span><span class="o">.</span><span class="n">get_gyro_z</span><span class="p">())</span>

        <span class="c1"># Update the current rotation speed</span>
        <span class="c1"># Note: it is possible that rotating the robot with positive power makes the IMU angle more negative</span>
        <span class="c1"># If this is the case, the PID will rotate forever. To fix, use &quot;-rot&quot; instead of &quot;rot&quot; below</span>
        <span class="n">main</span><span class="o">.</span><span class="n">robot</span><span class="o">.</span><span class="n">drive_helper</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rot</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">finish</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">was_interrupted</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="c1"># Stop moving motors</span>
        <span class="n">main</span><span class="o">.</span><span class="n">robot</span><span class="o">.</span><span class="n">drive_helper</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">should_continue</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># This action should stop when the robot has been &quot;close enough&quot; to the target angle for &quot;long enough&quot;</span>
        <span class="c1"># For this action, allow within 3 degrees of target angle</span>
        <span class="c1"># Require 10 iterations of being at the correct angle</span>
        <span class="c1"># 10 iterations at 50ms between each iteration = 0.5 second</span>
        <span class="c1"># Requiring the robot to be within 3 degrees of the correct angle for 0.5 seconds</span>
        <span class="c1"># prevents the action from stopping if the robot is oscillating through the correct angle</span>
        <span class="n">angle_error</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">main</span><span class="o">.</span><span class="n">robot</span><span class="o">.</span><span class="n">imu</span><span class="o">.</span><span class="n">get_gyro_z</span><span class="p">()</span> <span class="o">-</span> <span class="n">main</span><span class="o">.</span><span class="n">robot</span><span class="o">.</span><span class="n">rotate_pid</span><span class="o">.</span><span class="n">get_setpoint</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">angle_error</span> <span class="o">&lt;=</span> <span class="mf">3.0</span><span class="p">:</span>
            <span class="c1"># Within 3 degrees. Angle is correct</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">correct_counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Not within 3 degrees. Reset correct counter</span>
            <span class="c1"># Must be correct for 10 consecutive iterations before exit is valid</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">correct_counter</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Stop if correct_counter is at least 10, therefore continue if less than 10</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">correct_counter</span> <span class="o">&lt;</span> <span class="mi">10</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">RotatePIDAction</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Action</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="n">RotatePIDAction</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">degrees</span><span class="p">);</span>

<span class="k">protected</span><span class="o">:</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">begin</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">process</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">finish</span><span class="p">(</span><span class="kt">bool</span><span class="w"> </span><span class="n">wasInterrupted</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="nf">shouldContinue</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>

<span class="k">private</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// Store angle passed to action (angle to rotate)</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">degrees</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Used to detect when robot has reached its target</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">correctCounter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">RotatePIDAction</span><span class="o">::</span><span class="n">RotatePIDAction</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">degrees</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">degrees</span><span class="p">(</span><span class="n">degrees</span><span class="p">){</span>

<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="n">RotatePIDAction</span><span class="o">::</span><span class="n">begin</span><span class="p">(){</span>
<span class="w">    </span><span class="c1">// Reset correct counter to zero</span>
<span class="w">    </span><span class="n">correctCounter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Put motors in brake mode (often better for automated actions)</span>
<span class="w">    </span><span class="n">Main</span><span class="o">::</span><span class="n">robot</span><span class="o">-&gt;</span><span class="n">flmotor</span><span class="p">.</span><span class="n">setBrakeMode</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
<span class="w">    </span><span class="n">Main</span><span class="o">::</span><span class="n">robot</span><span class="o">-&gt;</span><span class="n">frmotor</span><span class="p">.</span><span class="n">setBrakeMode</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
<span class="w">    </span><span class="n">Main</span><span class="o">::</span><span class="n">robot</span><span class="o">-&gt;</span><span class="n">rlmotor</span><span class="p">.</span><span class="n">setBrakeMode</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
<span class="w">    </span><span class="n">Main</span><span class="o">::</span><span class="n">robot</span><span class="o">-&gt;</span><span class="n">rrmotor</span><span class="p">.</span><span class="n">setBrakeMode</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Configure rotate PID controller for use</span>
<span class="w">    </span><span class="c1">// Reset it to a clean state and set a new setpoint</span>
<span class="w">    </span><span class="c1">// Setpoint is target angle, which is self.degrees away from where the robot is currently facing</span>
<span class="w">    </span><span class="n">Main</span><span class="o">::</span><span class="n">robot</span><span class="o">-&gt;</span><span class="n">rotatePid</span><span class="p">.</span><span class="n">reset</span><span class="p">();</span>
<span class="w">    </span><span class="n">Main</span><span class="o">::</span><span class="n">robot</span><span class="o">-&gt;</span><span class="n">rotatePid</span><span class="p">.</span><span class="n">setSetpoint</span><span class="p">(</span><span class="n">Main</span><span class="o">::</span><span class="n">robot</span><span class="o">-&gt;</span><span class="n">imu</span><span class="p">.</span><span class="n">getGyroZ</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">degrees</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="n">RotatePIDAction</span><span class="o">::</span><span class="n">process</span><span class="p">(){</span>
<span class="w">    </span><span class="c1">// Calculate the rotation speed using the PID</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">rot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Main</span><span class="o">::</span><span class="n">robot</span><span class="o">-&gt;</span><span class="n">pid</span><span class="p">.</span><span class="n">get_output</span><span class="p">(</span><span class="n">Main</span><span class="o">::</span><span class="n">robot</span><span class="o">-&gt;</span><span class="n">imu</span><span class="p">.</span><span class="n">getGyroZ</span><span class="p">());</span>

<span class="w">    </span><span class="c1">// Update the current rotation speed</span>
<span class="w">    </span><span class="c1">// Note: it is possible that rotating the robot with positive power makes the IMU angle more negative</span>
<span class="w">    </span><span class="c1">// If this is the case, the PID will rotate forever. To fix, use &quot;-rot&quot; instead of &quot;rot&quot; below</span>
<span class="w">    </span><span class="n">Main</span><span class="o">::</span><span class="n">robot</span><span class="o">-&gt;</span><span class="n">driveHelper</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">rot</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="n">RotatePIDAction</span><span class="o">::</span><span class="n">finish</span><span class="p">(){</span>
<span class="w">    </span><span class="c1">// Stop moving motors</span>
<span class="w">    </span><span class="n">Main</span><span class="o">::</span><span class="n">robot</span><span class="o">-&gt;</span><span class="n">driveHelper</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">bool</span><span class="w"> </span><span class="n">RotatePIDAction</span><span class="o">::</span><span class="n">shouldContinue</span><span class="p">(){</span>
<span class="w">    </span><span class="c1">// This action should stop when the robot has been &quot;close enough&quot; to the target angle for &quot;long enough&quot;</span>
<span class="w">    </span><span class="c1">// For this action, allow within 3 degrees of target angle</span>
<span class="w">    </span><span class="c1">// Require 10 iterations of being at the correct angle</span>
<span class="w">    </span><span class="c1">// 10 iterations at 50ms between each iteration = 0.5 second</span>
<span class="w">    </span><span class="c1">// Requiring the robot to be within 3 degrees of the correct angle for 0.5 seconds</span>
<span class="w">    </span><span class="c1">// prevents the action from stopping if the robot is oscillating through the correct angle</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">angleError</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">Main</span><span class="o">::</span><span class="n">robot</span><span class="o">-&gt;</span><span class="n">imu</span><span class="p">.</span><span class="n">getGyroZ</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Main</span><span class="o">::</span><span class="n">robot</span><span class="o">-&gt;</span><span class="n">rotatePid</span><span class="p">.</span><span class="n">getSetpoint</span><span class="p">());</span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">angleError</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">3.0</span><span class="p">){</span>
<span class="w">        </span><span class="c1">// Within 3 degrees. Angle is correct</span>
<span class="w">        </span><span class="n">correctCounter</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Not within 3 degrees. Reset correct counter</span>
<span class="w">        </span><span class="c1">// Must be correct for 10 consecutive iterations before exit is valid</span>
<span class="w">        </span><span class="n">correctCounter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Stop if correctCounter is at least 10, therefore continue if less than 10</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">correctCounter</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>To make tuning the PID easier, it is recommended to create an instance of the action that rotates 90 degrees and add a trigger to run this action when a button is pressed. This will allow testing just this one action while tuning.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:3"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><input id="__tabbed_4_3" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">Python (<code>robot.py</code>)</label><label for="__tabbed_4_2">C++ (<code>robot.hpp</code>)</label><label for="__tabbed_4_3">C++ (<code>robot.cpp</code>)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># In Robot class&#39;s __init__ method</span>
<span class="n">TEST_BTN</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1"># In robot_started method</span>
<span class="n">ActionManager</span><span class="o">.</span><span class="n">add_trigger</span><span class="p">(</span><span class="n">ButtonPressedTrigger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gp0</span><span class="p">,</span> <span class="n">TEST_BTN</span><span class="p">,</span> <span class="n">RotatePIDAction</span><span class="p">(</span><span class="mi">90</span><span class="p">)))</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// Add with other constants (member variables)</span>
<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">ROTATE_TEST_BTN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// In robotStarted method</span>
<span class="n">ActionManager</span><span class="o">::</span><span class="n">addTrigger</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">ButtonPressedTrigger</span><span class="o">&gt;</span><span class="p">(</span><span class="n">gp0</span><span class="p">,</span><span class="w"> </span><span class="n">ROTATE_TEST_BTN</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">RotatePIDAction</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">90</span><span class="p">)))</span>
</code></pre></div>
</div>
</div>
</div>
<p>The PID is then ready to be tuned. It is advised to read the following section on tuning fully before tuning the PID if you are not familiar with tuning PID controllers. Additionally, if you wish to avoid having to rebuild / redeploy the robot program each time a gain is changed for the PID controller see the section on adding PID info to the Network Table below the tuning section.</p>
<h2 id="tuning-a-pid">Tuning a PID</h2>
<p>Tuning a PID is not a trivial process. The method described here is a basic "guess and check" method. There are mathematical methods of tuning, however a guess and check approach is often used in real world applications.</p>
<p>To tune a PID, choose a reasonable setpoint. The setpoint should be realistic for the use of the PID controller, but large enough to "see" what is happening if possible. For the rotation example above, 90 degrees is a good setpoint to tune with.</p>
<p>Generally, it is recommended to start with either only a kP (optionally with a kF). A kF is useful if the output should vary proportionally to the setpoint. For example, if the PID were to attempt to achieve a certain speed, the motor power (output of PID) would grow if speed grew. However, with rotation this is not the case (output of PID goes to motors, but a higher angle does not mean higher motor power forever).</p>
<p>If no kF is used, start with kP = 1.0, kI = 0.0, and kD = 0.0. If a kF is used, use 0.1 as the initial kP value. Note that an initial kF value can be selected by applying an output power and measuring the sensor value. Then <em>kF</em> = <em>sensor_measurement</em> ÷ <em>output_power</em>. Note that for the rotate PID, no kF should be used.</p>
<p>Once the initial values have been set, the following process is recommended for tuning.</p>
<ul>
<li>Multiply or divide by 10 for "coarse" tuning (larger changes)</li>
<li>Multiply of divide by 2 for "fine" tuning (smaller changes)</li>
<li>Finally, add and subtract small amounts for final tweaks.</li>
</ul>
<p>Tune parameters in the following order. Note that specific value recommendations are just guidelines, not rules that must be followed.</p>
<ul>
<li>Start with kP. If there is oscillation around the setpoint, reduce kP. If it never reaches the setpoint, increase kP. In a lot of cases with robotics, a small steady state error (slightly too small kP) is preferable to oscillation (slightly too large kP). Steady state error will be corrected with kI anyway.</li>
<li>Then tune kI. Start with 1 / 1000 of kP or 0.000001 (whichever is smaller). If steady state error is too large (or is corrected for too slowly) increase kI. If oscillation occurs and prevents the robot from ever settling at the target decrease kI. Some oscillation is ok as long as the robot reaches its target eventually (oscillation needs to decay and die off).</li>
<li>Finally tune kD. Start with 1 / 100 of kP or 0.0001 (whichever is smaller). If the oscillation is still too large, increase kD. If the robot behaves "erratically" decrease kD. Too large of a kD will cause unpredictable results. In many cases a kD of larger than 0.01 is a very bad idea.</li>
</ul>
<h2 id="extra-adding-pid-info-gains-to-network-table">Extra: Adding PID Info / Gains to Network Table</h2>
<p>When tuning a PID it is often useful to be able to edit the gains (kp, ki, kd and sometimes kf) without changing the code. The NetworkTable makes this possible. Indicators can be created for each gain and changed from the drive station. Changes will affect the PID controller in realtime. Once a good set of values is determined, they can be coped into the code and the NetworkTable code can optionally be removed.</p>
<p>The following example shows how to add controls for kp, ki, and kd, and kf for a PID controller in the <code>Robot</code> class called <code>pid</code>.</p>
<p>Add the following function to your <code>Robot</code> class</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:3"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><input id="__tabbed_5_3" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">Python (<code>robot.py</code>)</label><label for="__tabbed_5_2">C++ (<code>robot.hpp</code>)</label><label for="__tabbed_5_3">C++ (<code>robot.cpp</code>)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">pid_network_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pid</span><span class="p">:</span> <span class="n">PID</span><span class="p">):</span>
    <span class="c1"># Create net table keys for the given name of the PID</span>
    <span class="n">KP_KEY</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> kP&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">KI_KEY</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> kI&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">KD_KEY</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> kD&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">KF_KEY</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> kF&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="c1"># Add to network table if not already there</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">NetworkTable</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">KP_KEY</span><span class="p">):</span>
        <span class="n">NetworkTable</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">KP_KEY</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">pid</span><span class="o">.</span><span class="n">get_kp</span><span class="p">()))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">NetworkTable</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">KI_KEY</span><span class="p">):</span>
        <span class="n">NetworkTable</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">KI_KEY</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">pid</span><span class="o">.</span><span class="n">get_ki</span><span class="p">()))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">NetworkTable</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">KD_KEY</span><span class="p">):</span>
        <span class="n">NetworkTable</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">KD_KEY</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">pid</span><span class="o">.</span><span class="n">get_kd</span><span class="p">()))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">NetworkTable</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">KF_KEY</span><span class="p">):</span>
        <span class="n">NetworkTable</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">KF_KEY</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">pid</span><span class="o">.</span><span class="n">get_kf</span><span class="p">()))</span>

    <span class="c1"># If drive station edited a gain, update the pid object</span>
    <span class="c1"># If the value entered in the drive station is not a valid number,</span>
    <span class="c1"># the value will be discarded and reset to what the PID controller uses</span>
    <span class="k">if</span> <span class="n">NetworkTable</span><span class="o">.</span><span class="n">changed</span><span class="p">(</span><span class="n">KP_KEY</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">pid</span><span class="o">.</span><span class="n">set_kp</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">NetworkTable</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">KP_KEY</span><span class="p">)))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">NetworkTable</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">KP_KEY</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">pid</span><span class="o">.</span><span class="n">get_kp</span><span class="p">()))</span>
    <span class="k">if</span> <span class="n">NetworkTable</span><span class="o">.</span><span class="n">changed</span><span class="p">(</span><span class="n">KI_KEY</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">pid</span><span class="o">.</span><span class="n">set_ki</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">NetworkTable</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">KI_KEY</span><span class="p">)))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">NetworkTable</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">KI_KEY</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">pid</span><span class="o">.</span><span class="n">get_ki</span><span class="p">()))</span>
    <span class="k">if</span> <span class="n">NetworkTable</span><span class="o">.</span><span class="n">changed</span><span class="p">(</span><span class="n">KD_KEY</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">pid</span><span class="o">.</span><span class="n">set_kd</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">NetworkTable</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">KD_KEY</span><span class="p">)))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">NetworkTable</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">KD_KEY</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">pid</span><span class="o">.</span><span class="n">get_kd</span><span class="p">()))</span>
    <span class="k">if</span> <span class="n">NetworkTable</span><span class="o">.</span><span class="n">changed</span><span class="p">(</span><span class="n">KF_KEY</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">pid</span><span class="o">.</span><span class="n">set_kf</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">NetworkTable</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">KF_KEY</span><span class="p">)))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">NetworkTable</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">KF_KEY</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">pid</span><span class="o">.</span><span class="n">get_kf</span><span class="p">()))</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">pidNetworkTable</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">PID</span><span class="w"> </span><span class="o">&amp;</span><span class="n">pid</span><span class="p">);</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">Robot::pidNetworkTable</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">PID</span><span class="w"> </span><span class="o">&amp;</span><span class="n">pid</span><span class="p">){</span>
<span class="w">    </span><span class="c1">// Create net table keys for the given name of the pid</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">KP_KEY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; kP&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">KI_KEY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; kI&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">KD_KEY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; kD&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">KF_KEY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; kF&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Add to network table if not already there</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">NetworkTable</span><span class="o">::</span><span class="n">has</span><span class="p">(</span><span class="n">KP_KEY</span><span class="p">)){</span>
<span class="w">        </span><span class="n">NetworkTable</span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="n">KP_KEY</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">pid</span><span class="p">.</span><span class="n">getKp</span><span class="p">()));</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">NetworkTable</span><span class="o">::</span><span class="n">has</span><span class="p">(</span><span class="n">KI_KEY</span><span class="p">)){</span>
<span class="w">        </span><span class="n">NetworkTable</span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="n">KI_KEY</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">pid</span><span class="p">.</span><span class="n">getKi</span><span class="p">()));</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">NetworkTable</span><span class="o">::</span><span class="n">has</span><span class="p">(</span><span class="n">KD_KEY</span><span class="p">)){</span>
<span class="w">        </span><span class="n">NetworkTable</span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="n">KD_KEY</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">pid</span><span class="p">.</span><span class="n">getKd</span><span class="p">()));</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">NetworkTable</span><span class="o">::</span><span class="n">has</span><span class="p">(</span><span class="n">KF_KEY</span><span class="p">)){</span>
<span class="w">        </span><span class="n">NetworkTable</span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="n">KF_KEY</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">pid</span><span class="p">.</span><span class="n">getKf</span><span class="p">()));</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// If drive station edited a gain, update the pid object</span>
<span class="w">    </span><span class="c1">// If the value entered in the drive station is not a valid number,</span>
<span class="w">    </span><span class="c1">// the value will be discarded and reset to what the PID controller uses</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">NetworkTable</span><span class="o">::</span><span class="n">changed</span><span class="p">(</span><span class="n">ROTATE_KP_KEY</span><span class="p">)){</span>
<span class="w">        </span><span class="k">try</span><span class="p">{</span>
<span class="w">            </span><span class="n">rotatePid</span><span class="p">.</span><span class="n">setKp</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">stod</span><span class="p">(</span><span class="n">NetworkTable</span><span class="o">::</span><span class="n">get</span><span class="p">(</span><span class="n">ROTATE_KP_KEY</span><span class="p">)));</span>
<span class="w">        </span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">invalid_argument</span><span class="w"> </span><span class="o">&amp;</span><span class="n">e</span><span class="p">){</span>
<span class="w">            </span><span class="n">NetworkTable</span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="n">ROTATE_KP_KEY</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">rotatePid</span><span class="p">.</span><span class="n">getKp</span><span class="p">()));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">NetworkTable</span><span class="o">::</span><span class="n">changed</span><span class="p">(</span><span class="n">ROTATE_KI_KEY</span><span class="p">)){</span>
<span class="w">        </span><span class="k">try</span><span class="p">{</span>
<span class="w">            </span><span class="n">rotatePid</span><span class="p">.</span><span class="n">setKi</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">stod</span><span class="p">(</span><span class="n">NetworkTable</span><span class="o">::</span><span class="n">get</span><span class="p">(</span><span class="n">ROTATE_KI_KEY</span><span class="p">)));</span>
<span class="w">        </span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">invalid_argument</span><span class="w"> </span><span class="o">&amp;</span><span class="n">e</span><span class="p">){</span>
<span class="w">            </span><span class="n">NetworkTable</span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="n">ROTATE_KI_KEY</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">rotatePid</span><span class="p">.</span><span class="n">getKi</span><span class="p">()));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">NetworkTable</span><span class="o">::</span><span class="n">changed</span><span class="p">(</span><span class="n">ROTATE_KD_KEY</span><span class="p">)){</span>
<span class="w">        </span><span class="k">try</span><span class="p">{</span>
<span class="w">            </span><span class="n">rotatePid</span><span class="p">.</span><span class="n">setKd</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">stod</span><span class="p">(</span><span class="n">NetworkTable</span><span class="o">::</span><span class="n">get</span><span class="p">(</span><span class="n">ROTATE_KD_KEY</span><span class="p">)));</span>
<span class="w">        </span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">invalid_argument</span><span class="w"> </span><span class="o">&amp;</span><span class="n">e</span><span class="p">){</span>
<span class="w">            </span><span class="n">NetworkTable</span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="n">ROTATE_KD_KEY</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">rotatePid</span><span class="p">.</span><span class="n">getKd</span><span class="p">()));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>Then, for each PID you want on the NetworkTable, add a line like the following to the <code>Robot</code>'s <code>process</code> function. Make sure to use a unique name for each PID controller you add.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">Python (<code>robot.py</code>)</label><label for="__tabbed_6_2">C++ (<code>robot.cpp</code>)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="bp">self</span><span class="o">.</span><span class="n">pid_network_table</span><span class="p">(</span><span class="s2">&quot;Rotate PID&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate_pid</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">pidNetworkTable</span><span class="p">(</span><span class="s">&quot;Rotate PID&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">rotatePid</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>When run, this will crate network table entries that can be used to edit PID gains while the code is running.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs"], "search": "../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.b78d2936.min.js"></script>
      
    
  </body>
</html>